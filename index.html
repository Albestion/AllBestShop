<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Облік виготовленої продукції</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f9;
    padding: 30px;
}
h2 { text-align: center; }
.container {
    max-width: 900px;
    margin: auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.15);
}
input { padding: 8px; margin: 5px; width: 150px; }
button { padding: 8px 12px; cursor: pointer; border: none; border-radius: 4px; color: white; }
#addBtn { background-color: #2c3e50; }
.deleteBtn { background-color: #e74c3c; }
table { width: 100%; border-collapse: collapse; margin-top: 15px; }
th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
th { background: #2c3e50; color: white; cursor: pointer; position: relative; }
tr:nth-child(even) { background: #f9f9f9; }
.total { margin-top: 15px; font-weight: bold; font-size: 1.2em; }
th span.arrow { position: absolute; right: 8px; }
</style>
</head>
<body>

<div class="container">
<h2>Облік виготовленої продукції підприємства</h2>

<input type="text" id="name" placeholder="Назва продукції">
<input type="number" id="quantity" placeholder="Кількість">
<input type="number" id="price" placeholder="Ціна за одиницю">
<button id="addBtn" onclick="addProduct()">Додати</button>

<table>
<thead>
<tr>
<th data-column="name" onclick="sortTable(this)">Назва <span class="arrow"></span></th>
<th data-column="quantity" onclick="sortTable(this)">Кількість <span class="arrow"></span></th>
<th data-column="price" onclick="sortTable(this)">Ціна <span class="arrow"></span></th>
<th data-column="sum" onclick="sortTable(this)">Сума <span class="arrow"></span></th>
<th>Дія</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<div class="total">
Загальна сума: <span id="total">0</span> грн
</div>
</div>

<script>
let products = JSON.parse(localStorage.getItem("products")) || [];
let sortColumn = null;
let sortAsc = true;

function saveData() {
    localStorage.setItem("products", JSON.stringify(products));
}

function renderTable() {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";
    let totalSum = 0;

    products.forEach((product, index) => {
        let sum = product.quantity * product.price;
        totalSum += sum;
        tbody.innerHTML += `
        <tr>
            <td>${product.name}</td>
            <td>${product.quantity}</td>
            <td>${product.price}</td>
            <td>${sum}</td>
            <td><button class="deleteBtn" onclick="deleteProduct(${index})">Видалити</button></td>
        </tr>`;
    });

    document.getElementById("total").innerText = totalSum;
    updateArrows();
}

function addProduct() {
    let name = document.getElementById("name").value.trim();
    let quantity = parseFloat(document.getElementById("quantity").value);
    let price = parseFloat(document.getElementById("price").value);

    if (!name || quantity <= 0 || price <= 0) {
        alert("Заповніть всі поля правильно! Кількість та ціна мають бути > 0.");
        return;
    }

    products.push({ name, quantity, price });
    saveData();
    renderTable();

    document.getElementById("name").value = "";
    document.getElementById("quantity").value = "";
    document.getElementById("price").value = "";
}

function deleteProduct(index) {
    if (confirm("Видалити цей товар?")) {
        products.splice(index, 1);
        saveData();
        renderTable();
    }
}

function sortTable(th) {
    const column = th.dataset.column;
    if (sortColumn === column) sortAsc = !sortAsc;
    else { sortColumn = column; sortAsc = true; }

    products.sort((a, b) => {
        let valA, valB;
        if (column === 'sum') {
            valA = a.quantity * a.price;
            valB = b.quantity * b.price;
        } else {
            valA = a[column];
            valB = b[column];
        }

        if (typeof valA === 'string') {
            valA = valA.toLowerCase();
            valB = valB.toLowerCase();
        }

        if (valA > valB) return sortAsc ? 1 : -1;
        if (valA < valB) return sortAsc ? -1 : 1;
        return 0;
    });

    renderTable();
}

function updateArrows() {
    document.querySelectorAll('th span.arrow').forEach(span => span.innerText = '');
    if (!sortColumn) return;

    document.querySelectorAll(`th[data-column="${sortColumn}"] span.arrow`)
        .forEach(span => span.innerText = sortAsc ? '▲' : '▼');
}

renderTable();
</script>

</body>
</html>
